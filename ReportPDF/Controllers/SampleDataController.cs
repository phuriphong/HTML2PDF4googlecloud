using System;
using System.Collections.Generic;
using System.Globalization;
using System.IO;
using System.Linq;
using System.Net;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Text;
using System.Threading.Tasks;
using IronPdf;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.Mvc;
using Newtonsoft.Json;
using RestSharp;
using SCGEpur.Models;

namespace ReportPDF.Controllers
{
    [Route("api/[controller]")]
    public class SampleDataController : Controller
    {
        public SampleDataController(IHostingEnvironment env)
        {
            _env = env;

        }
        private static string[] Summaries = new[]
        {
            "Freezing", "Bracing", "Chilly", "Cool", "Mild", "Warm", "Balmy", "Hot", "Sweltering", "Scorching"
        };
        private readonly IHostingEnvironment _env;

        [HttpGet("[action]")]
        public IEnumerable<WeatherForecast> WeatherForecasts()
        {
            var rng = new Random();
            return Enumerable.Range(1, 5).Select(index => new WeatherForecast
            {
                DateFormatted = DateTime.Now.AddDays(index).ToString("d"),
                TemperatureC = rng.Next(-20, 55),
                Summary = Summaries[rng.Next(Summaries.Length)]
            });
        }
        [HttpGet("[action]")]
        public async Task<IActionResult> Language()
        {
            IronPdf.HtmlToPdf Renderer = new IronPdf.HtmlToPdf();
            Renderer.PrintOptions.InputEncoding = System.Text.Encoding.UTF8;
            var PDF = Renderer.RenderUrlAsPdf("https://en.wikipedia.org/wiki/Arabic");
            byte[] data = PDF.BinaryData;

            return await Task.Run(async () => File(data, "application/pdf"));
        }
        [HttpGet("[action]")]
        public async Task<IActionResult> sssAsync()
        {
            //HtmlToPdf htmlToPdfConverter = new HtmlToPdf();

            //StringBuilder builder = new StringBuilder("ทดสอบ");

            ////for (int i = 0; i < param.Count; i++)
            ////{
            ////    builder.Append(param[i].Description);
            ////    builder.Append("</br>");
            ////    builder.Append("</br>");
            ////}
            //builder.Replace("{StartDate}", "ทดสอบการแทนค่า");
            //var OutputPath = "HtmlToPDF.pdf";
            //htmlToPdfConverter.ConvertHtmlToFile(builder.ToString(), null, OutputPath);

            string Mappath = Path.Combine(_env.WebRootPath, "template", "AgmReport");
            var Renderer = new IronPdf.HtmlToPdf();
            Renderer.PrintOptions.MarginTop = 10;  //millimeters
            Renderer.PrintOptions.MarginLeft = 10;  //millimeters
            Renderer.PrintOptions.MarginRight = 10;  //millimeters
            Renderer.PrintOptions.MarginBottom = 9;  //millimeters
            Renderer.PrintOptions.InputEncoding = System.Text.Encoding.UTF8;

            Renderer.PrintOptions.CustomCssUrl = "https://stackpath.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.css";


            StringBuilder head = new StringBuilder(System.IO.File.ReadAllText(Path.Combine(Mappath, "header.html")));
            var json = System.IO.File.ReadAllText(Path.Combine(Mappath, "data.json"));
            AgmHeader_Result H = (AgmHeader_Result)JsonConvert.DeserializeObject(json, typeof(AgmHeader_Result));
            var StartDateString = H.StartDate.ToString("d MMMM yyyy", new CultureInfo("th-TH", true));
            var EndDateString = H.EndDate.ToString("d MMMM yyyy", new CultureInfo("th-TH", true));
            head.Replace("{{header}}", string.Format("{0}  ({1} - {2})",
                H.StartDate.ToString("yyyy", new CultureInfo("th-TH", true)), StartDateString, EndDateString));
            head.Replace("{{AgmNo}}", H.AgmNo);
            head.Replace("{{DocDateString}}", H.DocDate.ToString("d MMMM yyyy", new CultureInfo("th-TH", true)));
            Renderer.PrintOptions.Header = new HtmlHeaderFooter()
            {
                Height = 50,
                Spacing = 0,
                //LoadStylesAndCSSFromMainHtmlDocument = true,
                HtmlFragment = head.ToString()
                //"<table style='width: 100 %;border:1px solid #d13b3b;'><tr><td style='width: 50 %;'><img src='data:image / png; base64,iVBORw0KGgoAAAANSUhEUgAAAnAAAABACAIAAAAVlN1wAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAGxnSURBVHhe7b1nWBRbuy16f9z73HP22XuvtczkjBiQJCAgIBlBgkpGQMSIASMKIpgQMKGCWTGLmABzRFEUFCNBJRoAQWhC59zeUV1N2wK6MK7v27fHMx / onj1r5vmOd1TNqvq / PsohhxxyyCGHHD8MOaHKIYcccsghx0 + AnFDlkEMOOeSQ4ydATqhyyCGHHHLI8RMgJ1Q55Pj5EHVC8r0bJD8jwReTyCHHPw / JLP0XwL9INb6O30uoIpHwVYWI0vqRzxex2cKaGlFLi + SnH4PgzVtefr4QOcvxbwsajfb69euamhoGnS6J + vdER0fH0SNHVsUnnMs9x + FwJLEygGkoLytLWpu4ZfPm0pJSSey / G3g8Xn19fXV1VXV1NYVC + bewd98HoVDY0NBQW1PT2Nj4e5r59u1bLASUSPmyhcR6QZo3r18z6AxJ1M9GZUVF + ra0dWsTz5 / reSb / HqDoq5evxMeuOJ97jsViSWJ7B4FAUFdXh5788OGDJOpX4jcSKo3GOXyYtXqNsLGJvX8 / 79493vUbzBXxghcvJAl + AJxjmR0uY3lFRZLvcvwb4vLFS + GhYYG + fndu50ui / j0Ba + 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'></td>"
                //                + "<td style='width: 50 %;text-align: right;'> Page {page} of {total-pages}</td></tr></table>",
                //    //BaseUrl = new Uri(@"C:\assets\images\").AbsoluteUri
            };

            // Renderer.PrintOptions.Header.RightText = "Page {page} of {total-pages}";
            // Advanced:  Load external html assets: images, css and javascript.
            // An optional "base" asset locading path can be set as a url or local directory. 


            StringBuilder body = new StringBuilder(System.IO.File.ReadAllText(Path.Combine(Mappath, "body.html")));
            //ody.Replace("{{font}}", Path.Combine(_env.WebRootPath, "template", "AgmReport","angsa.woff"));
            if (H != null)
            {
                var RecordNumber = 1;
                body.Replace("{{SupplierName}}", H.SupplierName);
                body.Replace("{{SupplierCode}}", H.SupplierCode);
                var CatList = string.Join(",", H.AgmItem.Select(s => s.CateName).ToArray());
                body.Replace("{{CatList}}", CatList);
                if (H.AgmSelectedTab.CreditFlag)
                {
                    var CreditYear = H.AgmCredit.First().Year;
                    var CreditPeriod = H.AgmCredit.First().Period;
                    var CreditPeriodName = H.AgmCredit.First().PeriodName;
                    var NoofColumn = H.AgmCredit.First().NoofColumn;
                    StringBuilder table = new StringBuilder();
                    StringBuilder AgmCredit = new StringBuilder(System.IO.File.ReadAllText(Path.Combine(Mappath, "AgmCredit.html")));

                    AgmCredit.Replace("{{CreditYear}}", CreditYear);
                    AgmCredit.Replace("{{CreditPeriodName}}", CreditPeriodName);
                    AgmCredit.Replace("{{RecordNumber}}", (++RecordNumber).ToString());

                    table.Append("<table style='margin: 0 auto;' class='table2' ><tr>    " +
                        "<th style='width: 30px;text-align:  center' class='align-middle'>#</th>" +
                        "<th style='width: 150px;text-align:  center' class='align-middle'>Item Category </th>" +
                        "<th style='width: 150px;text-align:  center' class='align-middle'>Item Sub Category </th>" +
                             "{{header}}</tr>{{detail}}</table>");
                    var header = new StringBuilder();
                    if (CreditPeriod == "M")
                    {
                        foreach (var row in new string[] { "Jan", "Feb", "Mar", "Apr", "May", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec" })
                        {
                            header.AppendFormat("<th style='width: 100px; text-align: center'>{0}</th>", row);
                        }
                    }
                    else if (CreditPeriod == "Q")
                    {

                        header.AppendFormat("<th style='width: 100px; text-align: center'>{0}</th>", "ไตรมาสที่ 1");
                        header.AppendFormat("<th style='width: 100px; text-align: center'>{0}</th>", "ไตรมาสที่ 2");
                        header.AppendFormat("<th style='width: 100px; text-align: center'>{0}</th>", "ไตรมาสที่ 3");
                        header.AppendFormat("<th style='width: 100px; text-align: center'>{0}</th>", "ไตรมาสที่ 4");

                    }
                    else if (CreditPeriod == "H")
                    {

                        header.AppendFormat("<th style='width: 100px; text-align: center'>{0}</th>", "Jan-Jun");
                        header.AppendFormat("<th style='width: 100px; text-align: center'>{0}</th>", "Jul-Dec");

                    }
                    else if (CreditPeriod == "Y")
                    {

                        header.AppendFormat("<th style='width: 100px; text-align: center'>{0}</th>", "Jan-Dec");

                    }
                    else
                    {
                        for (int i = 1; i <= NoofColumn; i++)
                        {
                            header.AppendFormat("<th style='width: 100px; text-align: center'>{0}</th>", i);
                        }
                    }
                    table.Replace("{{header}}", header.ToString());
                    var detail = new StringBuilder();
                    var no = 1;
                    foreach (var item in H.AgmCredit)
                    {
                        detail.Append("<tr>");
                        detail.AppendFormat("<td class='text-center'>{0}</td>", no++);
                        detail.AppendFormat("<td class='text-left'>{0}</td>", item.CategoryName);
                        detail.AppendFormat("<td class='text-left'>{0}</td>", item.SubCategoryName);
                        for (int i = 1; i <= NoofColumn; i++)
                        {
                            var obj = item.GetType().GetProperty("Value" + i).GetValue(item, null);

                            detail.AppendFormat("<td class='text-right'>{0:#,##0.00}</td>", obj);
                        }
                        detail.Append("</tr>");
                    }
                    table.Replace("{{detail}}", detail.ToString());
                    AgmCredit.Replace("{{AgmCreditTable}}", table.ToString());
                    body.Replace("{{AgmCredit}}", AgmCredit.ToString());

                }
                else
                {
                    body.Replace("{{AgmCredit}}", "");
                }
                if (H.AgmSelectedTab.RebateFlag)
                {
                    var rebatelist = new StringBuilder();
                    StringBuilder AgmRebate = new StringBuilder(
                        @"<div class='row'>
                          <br>
                         </div>
                        <div class='row'>
                            <div class='col-sm-12'>
                                <label class='font-weight-bold'>{{RecordNumber}}. อัตราผลประโยชน์(Rebate)</label>
                            </div>

                        </div>
                    {{AgmRebateRow}}");


                    AgmRebate.Replace("{{RecordNumber}}", (++RecordNumber).ToString());
                    var rebateNo = 1;

                    foreach (var row in H.AgmRebate)
                    {
                        var AgmRebateRow = new StringBuilder(System.IO.File.ReadAllText(Path.Combine(Mappath, "AgmRebate.html")));
                        AgmRebateRow.Replace("{{CalByName}}", row.CalByName);
                        AgmRebateRow.Replace("{{PeriodName}}", row.PeriodName);
                        AgmRebateRow.Replace("{{PaymentMethodName}}", row.PaymentMethodName);

                        AgmRebateRow.Replace("{{row1}}", row.RebateType == "NT" ?
                            string.Format("{0}.{1} {2}", RecordNumber, rebateNo, row.RebateTypeName) :
                            string.Format("{0}.{1} อัตราตามเป้าหมาย", RecordNumber, rebateNo));
                        rebateNo++;
                        AgmRebateRow.Replace("{{row2}}", row.RebateType == "NT" ? string.Format("{0} {1} (นับจากบาทแรก)",
                            row.RebateStep.First().TargetAmount.Value.ToString("#,##0.00"), row.Unit) : row.RebateTypeName);

                        var subNo = 1;
                        var subdetail = new StringBuilder();
                        foreach (var item in H.AgmItem)
                        {
                            var dd = new StringBuilder("<tr><td class='text-center'>{{sub.No}}</td><td>{{sub.CateName}}</td><td>{{sub.SubCateName}}</td></tr>");
                            dd.Replace("{{sub.No}}", (subNo++).ToString());
                            dd.Replace("{{sub.CateName}}", item.CateName);
                            dd.Replace("{{sub.SubCateName}}", item.SubCateName);
                            subdetail.Append(dd);
                        }
                        AgmRebateRow.Replace("{{Subitem}}", subdetail.ToString());
                        if (row.RebateType != "NT")
                        {
                            subNo = 1;
                            StringBuilder bodystep = new StringBuilder();
                            var AgmRebateStep = new StringBuilder(System.IO.File.ReadAllText(Path.Combine(Mappath, "AgmRebateStep.html")));
                            foreach (var item in row.RebateStep)
                            {
                                var dd = new StringBuilder("<tr><td class='text-center'>{{step.No}}</td><td class='text-right'>{{step.StepAmount}}</td><td class='text-right'>{{step.TargetAmount}}</td></tr>");
                                dd.Replace("{{step.No}}", (subNo++).ToString());
                                dd.Replace("{{step.StepAmount}}", string.Format("{0:#,##.0}", item.StepAmount));
                                dd.Replace("{{step.TargetAmount}}", string.Format("{0:#,##.0}", item.TargetAmount));
                                bodystep.Append(dd);
                            }
                            AgmRebateStep.Replace("{{body}}", bodystep.ToString());
                            AgmRebateRow.Replace("{{AgmRebateStep}}", AgmRebateStep.ToString());
                        }
                        else
                        {
                            AgmRebateRow.Replace("{{AgmRebateStep}}", "");
                        }
                        rebatelist.Append(AgmRebateRow.ToString());
                    }
                    AgmRebate.Replace("{{AgmRebateRow}}", rebatelist.ToString());
                    body.Replace("{{AgmRebate}}", AgmRebate.ToString());
                }
                else
                {
                    body.Replace("{{AgmRebate}}", "");
                }
                if (H.AgmSelectedTab.MarketingFeeFlag)
                {
                    var AgmMarketingFee = new StringBuilder(
                        @"
                   <div class='row' >
                    <div class='col-sm-12'>
                        <label class='font-weight-bold' >{{RecordNumber}}. ค่าสนับสนุนกิจกรรมส่งเสริมการขาย(Marketing Fee)</label>
                    </div>
                   </div>
                {{AgmMarketingFeeItem}}");
                    var AgmMarketingFeeItemList = new StringBuilder();
                    AgmMarketingFee.Replace("{{RecordNumber}}", (++RecordNumber).ToString());
                    var MaNO = 1;
                    foreach (var row in H.AgmMarketingFee)
                    {
                        var AgmMarketingFeeItem = new StringBuilder(System.IO.File.ReadAllText(Path.Combine(Mappath, "AgmMarketingFee.html")));
                        AgmMarketingFeeItem.Replace("{{RecordNumber}}", (RecordNumber).ToString());
                        AgmMarketingFeeItem.Replace("{{row.No}}", (MaNO++).ToString());
                        AgmMarketingFeeItem.Replace("{{row.Description}}", row.Description);
                        AgmMarketingFeeItem.Replace("{{row.Unit}}", row.Unit);
                        AgmMarketingFeeItem.Replace("{{row.CalByName}}", row.CalByName);
                        AgmMarketingFeeItem.Replace("{{row.PeriodName}}", row.PeriodName);
                        AgmMarketingFeeItem.Replace("{{row.PaymentMethodName}}", row.PaymentMethodName);

                        AgmMarketingFeeItem.Replace("{{row.TargetAmount}}", string.Format(row.SupType == "Percent" ? "{0:#,##0}" : "{0:#,##0.00}", row.TargetAmount));
                        AgmMarketingFeeItem.Replace("{{row.SupAmount}}", string.Format(row.SupType == "Percent" ? "{0:#,##0}" : "{0:#,##0.00}", row.SupAmount));

                        AgmMarketingFeeItemList.Append(AgmMarketingFeeItem);
                    }
                    AgmMarketingFee.Replace("{{AgmMarketingFeeItem}}", AgmMarketingFeeItemList.ToString());
                    body.Replace("{{AgmMarketingFee}}", AgmMarketingFee.ToString());
                }
                else
                {
                    body.Replace("{{AgmMarketingFee}}", "");
                }
                if (H.AgmSelectedTab.DCChargeFlag)
                {
                    var AgmDCCharge = new StringBuilder(System.IO.File.ReadAllText(Path.Combine(Mappath, "AgmDCCharge.html")));
                    AgmDCCharge.Replace("{{RecordNumber}}", (++RecordNumber).ToString());
                    AgmDCCharge.Replace("{{CalByName}}", H.AgmDCCharge.CalByName);
                    AgmDCCharge.Replace("{{Unit}}", H.AgmDCCharge.Unit);
                    AgmDCCharge.Replace("{{PeriodName}}", H.AgmDCCharge.PeriodName);
                    AgmDCCharge.Replace("{{PaymentMethodName}}", H.AgmDCCharge.PaymentMethodName);
                    AgmDCCharge.Replace("{{Note}}", H.AgmDCCharge.Note);
                    AgmDCCharge.Replace("{{SupAmount}}", string.Format(H.AgmDCCharge.SupType == "Percent" ? "{0:#,##0}" : "{0:#,##0.00}", H.AgmDCCharge.SupAmount));

                    body.Replace("{{AgmDCCharge}}", AgmDCCharge.ToString());
                }
                else
                {
                    body.Replace("{{AgmDCCharge}}", "");
                }
                if (H.AgmSelectedTab.DamageFlag)
                {
                    var AgmDamage = new StringBuilder(System.IO.File.ReadAllText(Path.Combine(Mappath, "AgmDamage.html")));
                    AgmDamage.Replace("{{RecordNumber}}", (++RecordNumber).ToString());
                    AgmDamage.Replace("{{CalByName}}", H.AgmDamage.CalByName);
                    AgmDamage.Replace("{{Unit}}", H.AgmDamage.Unit);
                    AgmDamage.Replace("{{Note}}", H.AgmDamage.Note);
                    AgmDamage.Replace("{{SupAmount}}", string.Format(H.AgmDamage.SupType == "Percent" ? "{0:#,##0}" : "{0:#,##0.00}", H.AgmDamage.SupAmount));

                    body.Replace("{{AgmDamage}}", AgmDamage.ToString());
                }
                else
                {
                    body.Replace("{{AgmDamage}}", "");
                }
                StringBuilder ListOther = new StringBuilder();
                if (H.AgmSelectedTab.CustomizeFlag || H.AgmSelectedTab.NewStoreFlag
                    || H.AgmSelectedTab.NewProductFlag || H.AgmSelectedTab.CreditTermFlag)
                {
                    if (H.AgmSelectedTab.CustomizeFlag)
                    {
                        foreach (var item in H.AgmOther.Where(x => x.OtherType == "Customize"))
                        {

                            var CustomizeTem = new StringBuilder(@"<div class='row'>
                                            <br >
                                            </div >
                                            <div class='row' >
                                            <div class='col-sm-12'>
                                                <label class='font-weight-bold ' style='word-wrap: break-word;' >{{RecordNumber}}. {{Description}}</label>
                                            </div>
                                        </div>
                                        <div class='row' >
                                            <div class='col-sm-1 text-right'>
                                            </div>
                                            <div class='col-sm-11'>
                                              <div class='row'>
                                                <div class='col-sm-4'><label class='font-weight-bold'> อัตราค่าบริการศูนย์กระจายสินค้า</label></div>
                                                <div class='col-sm-2' >{{SupAmount}}  {{Unit}}</div>
                                                <div class='col-sm-2'><label class='font-weight-bold'> คำนวณจาก</label></div>
                                                <div class='col-sm-2'>{{CalByName}}</div>
                                              </div>
                                            </div>
                                          </div>
                                          <div class='row' >
                                            <div class='col-sm-1 text-right'>
     
                                            </div>
                                            <div class='col-sm-11'>
                                              <div class='row'>
                                                <div class='col-sm-4'><label class='font-weight-bold'> วิธีการจ่ายชำระ-ผลประโยชน์</label></div>
                                                <div class='col-sm-6'>{{PaymentMethodName}}</div>
                                              </div>
                                            </div>
                                          </div>");
                            CustomizeTem.Replace("{{RecordNumber}}", (++RecordNumber).ToString());
                            CustomizeTem.Replace("{{CalByName}}", item.CalByName);
                            CustomizeTem.Replace("{{Unit}}", item.Unit);
                            CustomizeTem.Replace("{{Description}}", item.Description);
                            CustomizeTem.Replace("{{PaymentMethodName}}", item.PaymentMethodName);
                            CustomizeTem.Replace("{{SupAmount}}", string.Format(item.SupType == "Percent" ? "{0:#,##0}" : "{0:#,##0.00}", item.SupAmount));
                            ListOther.Append(CustomizeTem.ToString());
                        }
                    }
                    if (H.AgmSelectedTab.NewProductFlag || H.AgmSelectedTab.CreditTermFlag || H.AgmSelectedTab.NewStoreFlag)
                    {
                        foreach (var item in H.AgmOther.Where(x => x.OtherType != "Customize"))
                        {

                            StringBuilder otherTem = null;
                            switch (item.OtherType)
                            {
                                case "Store": otherTem = new StringBuilder(@"<div class='row'>
                                            <br >
                                            </div >
                                            <div class='row' >
                                            <div class='col-sm-12'>
                                                <label class='font-weight-bold ' style='word-wrap: break-word;' >{{RecordNumber}}. ส่วนลดสำหรับเปิดสาขาใหม่ (Discout for New Store Opening)</label>
                                            </div>
                                        </div>
                                            <div class='row' >
                                            <div class='col-sm-1 text-right'>
                                           </div>
                                           <div class='col-sm-11'>
                                             <div class='row'>
                                               <div class='col-sm-1'><label class='font-weight-bold'>เงื่อนไข</label></div>
                                               <div class='col-sm-11 ' style='word-wrap: break-word;'>{{Description}}</div>
                                              </div>
                                            </div>
                                          </div>
                                        <div class='row' >
                                            <div class='col-sm-1 text-right'>
                                            </div>
                                            <div class='col-sm-11'>
                                              <div class='row'>
                                                <div class='col-sm-4'><label class='font-weight-bold'> อัตราค่าบริการศูนย์กระจายสินค้า</label></div>
                                                <div class='col-sm-2' >{{SupAmount}}  {{Unit}}</div>
                                                <div class='col-sm-2'><label class='font-weight-bold'> คำนวณจาก</label></div>
                                                <div class='col-sm-2'>{{CalByName}}</div>
                                              </div>
                                            </div>
                                          </div>
                                          <div class='row' >
                                            <div class='col-sm-1 text-right'>
     
                                            </div>
                                            <div class='col-sm-11'>
                                              <div class='row'>
                                                <div class='col-sm-4'><label class='font-weight-bold'> วิธีการจ่ายชำระ-ผลประโยชน์</label></div>
                                                <div class='col-sm-6'>{{PaymentMethodName}}</div>
                                              </div>
                                            </div>
                                          </div>"); break;
                                case "Prod": otherTem = new StringBuilder(@"<div class='row'>
                                            <br >
                                            </div >
                                            <div class='row' >
                                            <div class='col-sm-12'>
                                                <label class='font-weight-bold ' style='word-wrap: break-word;' >{{RecordNumber}}. ส่วนลดสำหรับสินค้าใหม่ (Discount for New Products)</label>
                                            </div>
                                        </div>
                                        <div class='row' >
                                            <div class='col-sm-1 text-right'>
                                            </div>
                                            <div class='col-sm-11'>
                                              <div class='row'>
                                                <div class='col-sm-4'><label class='font-weight-bold'> อัตราค่าบริการศูนย์กระจายสินค้า</label></div>
                                                <div class='col-sm-2' >{{SupAmount}}  {{Unit}}</div>
                                                <div class='col-sm-2'><label class='font-weight-bold'> คำนวณจาก</label></div>
                                                <div class='col-sm-2'>{{CalByName}}</div>
                                              </div>
                                            </div>
                                          </div>
                                          <div class='row' >
                                            <div class='col-sm-1 text-right'>
     
                                            </div>
                                            <div class='col-sm-11'>
                                              <div class='row'>
                                                <div class='col-sm-4'><label class='font-weight-bold'> วิธีการจ่ายชำระ-ผลประโยชน์</label></div>
                                                <div class='col-sm-6'>{{PaymentMethodName}}</div>
                                              </div>
                                            </div>
                                          </div>"); break;
                                case "CreditTerm": otherTem = new StringBuilder(@"<div class='row'>
                                            <br >
                                            </div >
                                            <div class='row' >
                                            <div class='col-sm-12'>
                                                <label class='font-weight-bold ' style='word-wrap: break-word;' >{{RecordNumber}}. เครดิตพิเศษ</label>
                                            </div>
                                        </div>
                                        <div class='row'>
                                            <div class='col-sm-1 text-right'>
     
                                            </div>
                                            <div class='col-sm-11'>
                                              <div class='row'>
                                                <div class='col-sm-2'><label class='font-weight-bold'>เครดิตปกติ</label></div>
                                                <div class='col-sm-2 text-right'>{{OldCreditTerm}} วัน</div>
       
                                              </div>

                                            </div>
                                          </div>
                                          <div class='row' >
                                            <div class='col-sm-1 text-right'>
     
                                            </div>
                                            <div class='col-sm-11'  >
                                              <div class='row' >
                                                <div class='col-sm-2'><label class='font-weight-bold'>เครดิตพิเศษ</label></div>
                                                <div class='col-sm-2 text-right'>{{NewCreditTerm}} วัน</div>
       
                                              </div>

                                            </div>
                                          </div>"); break;
                                default:
                                    break;
                            }

                            otherTem.Replace("{{RecordNumber}}", (++RecordNumber).ToString());
                            otherTem.Replace("{{CalByName}}", item.CalByName);
                            otherTem.Replace("{{OldCreditTerm}}", string.Format("{0:#,##0}", item.OldCreditTerm));
                            otherTem.Replace("{{NewCreditTerm}}", string.Format("{0:#,##0}", item.NewCreditTerm));
                            otherTem.Replace("{{Unit}}", item.Unit);
                            otherTem.Replace("{{Description}}", item.Description);
                            otherTem.Replace("{{PaymentMethodName}}", item.PaymentMethodName);
                            otherTem.Replace("{{SupAmount}}", string.Format(item.SupType == "Percent" ? "{0:#,##0}" : "{0:#,##0.00}", item.SupAmount));
                            ListOther.Append(otherTem.ToString());
                        }
                    }
                    body.Replace("{{AgmOther}}", ListOther.ToString());
                }
                else
                {
                    body.Replace("{{AgmOther}}", "");
                }
                var Footer = new StringBuilder(System.IO.File.ReadAllText(Path.Combine(Mappath, "Footer.html")));
                var Signer = "1";
                var AgmSignatureSCG = H.AgmSignature.First(x => (!x.VendorFlag && x.SignatureType == Signer));
                var AgmSignatureVendor = H.AgmSignature.First(x => (x.VendorFlag && x.SignatureType == Signer));
                Footer.Replace("{{SignatureSCGName}}", AgmSignatureSCG.Name);
                Footer.Replace("{{SignatureSCGPosition}}", AgmSignatureSCG.Position);
                Footer.Replace("{{SignatureVendorName}}", AgmSignatureVendor.Name);
                Footer.Replace("{{SignatureVendorPosition}}", AgmSignatureVendor.Position);

                StringBuilder ListWitness = new StringBuilder();
                foreach (var item in H.AgmSignature.Where(x => x.VendorFlag && x.SignatureType != Signer))
                {

                    var s = new StringBuilder(@" <div class='row'>
                      <br >
                    </div ><div class='row'>
                                            <div class='col-sm-3'></div>
                                            <div class='col-sm-6 text-center'>
                                                <span class='font-weight-bold'>________________________</span>
                                            </div>
                                            <div class='col-sm-3'></div>
                                        </div>
                                        <div class='row'>
                                            <div class='col-sm-3'></div>
                                            <div class='col-sm-6  text-center'>
                                                <span class='font-weight-bold'>( {{Name}} )</span>
                                            </div>
                                            <div class='col-sm-3'></div>
                                        </div>
                                        <div class='row'>
                                            <div class='col-sm-3'></div>
                                            <div class='col-sm-6  text-center'>
                                                <span class='font-weight-bold'>{{Position}}</span>
                                            </div>
                                            <div class='col-sm-3'></div>
                                        </div>
                                        <div class='row'>
                                            <div class='col-sm-3'></div>
                                            <div class='col-sm-6 text-center'>
                                                <span class='font-weight-bold'>วันที่ ____________________</span>
                                            </div>
                                            <div class='col-sm-3'></div>
                                        </div>
                                        <div class='row'>
                                            <br>
                                        </div>");
                    s.Replace("{{Name}}", item.Name);
                    s.Replace("{{Position}}", item.Position);
                    ListWitness.Append(s);
                }
                Footer.Replace("{{WitnessSCG}}", ListWitness.ToString());
                ListWitness = new StringBuilder();
                foreach (var item in H.AgmSignature.Where(x => !x.VendorFlag && x.SignatureType != Signer))
                {

                    var s = new StringBuilder(@" <div class='row'>
                      <br >
                    </div ><div class='row'>
                                            <div class='col-sm-3'></div>
                                            <div class='col-sm-6 text-center'>
                                                <span class='font-weight-bold'>________________________</span>
                                            </div>
                                            <div class='col-sm-3'></div>
                                        </div>
                                        <div class='row'>
                                            <div class='col-sm-3'></div>
                                            <div class='col-sm-6  text-center'>
                                                <span class='font-weight-bold'>( {{Name}} )</span>
                                            </div>
                                            <div class='col-sm-3'></div>
                                        </div>
                                        <div class='row'>
                                            <div class='col-sm-3'></div>
                                            <div class='col-sm-6  text-center'>
                                                <span class='font-weight-bold'>{{Position}}</span>
                                            </div>
                                            <div class='col-sm-3'></div>
                                        </div>
                                        <div class='row'>
                                            <div class='col-sm-3'></div>
                                            <div class='col-sm-6 text-center'>
                                                <span class='font-weight-bold'>วันที่ ____________________</span>
                                            </div>
                                            <div class='col-sm-3'></div>
                                        </div>
                                        <div class='row'>
                                            <br>
                                        </div>");
                    s.Replace("{{Name}}", item.Name);
                    s.Replace("{{Position}}", "พยาน");
                    ListWitness.Append(s);

                }
                Footer.Replace("{{WitnessVendor}}", ListWitness.ToString());
                body.Replace("{{Footer}}", Footer.ToString());

            }
            var PDF = Renderer.RenderHtmlAsPdf(body.ToString());
            //var  = Renderer.RenderHtmlAsPdf("<div class='container-fluid'> <div class='row'> <div class='col-md-12'> <nav class='navbar navbar-expand-lg navbar-light bg-light'> <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#bs-example-navbar-collapse-1'> <span class='navbar-toggler-icon'></span> </button> <a class='navbar-brand' href='#'>Brand</a> <div class='collapse navbar-collapse' id='bs-example-navbar-collapse-1'> <ul class='navbar-nav'> <li class='nav-item active'> <a class='nav-link' href='#'>Link<span class='sr-only'>(current)</span></a> </li> <li class='nav-item'> <a class='nav-link' href='#'>Link</a> </li> <li class='nav-item dropdown'> <a class='nav-link dropdown-toggle' href='http://example.com' id='navbarDropdownMenuLink' data-toggle='dropdown'>Dropdown link</a> <div class='dropdown-menu' aria-labelledby='navbarDropdownMenuLink'> <a class='dropdown-item' href='#'>Action</a> <a class='dropdown-item' href='#'>Another action</a> <a class='dropdown-item' href='#'>Something else here</a> <div class='dropdown-divider'> </div> <a class='dropdown-item' href='#'>Separated link</a> </div> </li> </ul> <form class='form-inline'> <input class='form-control mr-sm-2' type='text' /> <button class='btn btn-primary my-2 my-sm-0' type='submit'> Search </button> </form> <ul class='navbar-nav ml-md-auto'> <li class='nav-item active'> <a class='nav-link' href='#'>Link<span class='sr-only'>(current)</span></a> </li> <li class='nav-item dropdown'> <a class='nav-link dropdown-toggle' href='http://example.com' id='navbarDropdownMenuLink' data-toggle='dropdown'>Dropdown link</a> <div class='dropdown-menu dropdown-menu-right' aria-labelledby='navbarDropdownMenuLink'> <a class='dropdown-item' href='#'>Action</a> <a class='dropdown-item' href='#'>Another action</a> <a class='dropdown-item' href='#'>Something else here</a> <div class='dropdown-divider'> </div> <a class='dropdown-item' href='#'>Separated link</a> </div> </li> </ul> </div> </nav> <div class='jumbotron'> <h2> Hello, world! </h2> <p> This is a template for a simple marketing or informational website.It includes a large callout called the hero unit and three supporting pieces of content. Use it as a starting point to create something more unique. </p> <p> <a class='btn btn-primary btn-large' href='#'>Learn more</a> </p> </div> </div> </div> <div class='row'> <div class='col-md-4'> <h2> Heading </h2> <p> Donec id elit non mi porta gravida at eget metus.Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.Etiam porta sem malesuada magna mollis euismod.Donec sed odio dui. </p> <p> <a class='btn' href='#'>View details »</a> </p> </div> <div class='col-md-4'> <h2> Heading </h2> <p> Donec id elit non mi porta gravida at eget metus.Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.Etiam porta sem malesuada magna mollis euismod.Donec sed odio dui. </p> <p> <a class='btn' href='#'>View details »</a> </p> </div> <div class='col-md-4'> <h2> Heading </h2> <p> Donec id elit non mi porta gravida at eget metus.Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.Etiam porta sem malesuada magna mollis euismod.Donec sed odio dui. </p> <p> <a class='btn' href='#'>View details »</a> </p> </div> </div> </div>");
            //var PDF = Renderer.RenderUrlAsPdf(new Uri("https://www.layoutit.com/build"));
            //var PDF = Renderer.RenderHtmlAsPdf(
            //    " <table style='width: 100 %;height: 2000px;border:1px solid #d13b3b;'> <thead> <tr> <th> # </th> <th> Product </th> <th> Payment Taken </th> <th> Status </th> </tr> </thead> <tbody> <tr> <td> 1 </td> <td> TB - Monthly </td> <td> 01/04/2012 </td> <td> Default </td> </tr> <tr class='table - active'> <td> 1 </td> <td> TB - Monthly </td> <td> 01/04/2012 </td> <td> Approved </td> </tr> <tr class='table - success'> <td> 2 </td> <td> TB - Monthly </td> <td> 02/04/2012 </td> <td> Declined </td> </tr> <tr class='table - warning'> <td> 3 </td> <td> TB - Monthly </td> <td> 03/04/2012 </td> <td> Pending </td> </tr> <tr class='table - danger'> <td> 4 </td> <td> TB - Monthly </td> <td> 04/04/2012 </td> <td> Call in to confirm </td> </tr> </tbody> </table>");
            ////PDF.SaveAs(OutputPath);
            //byte[] data = htmlToPdfConverter.ConvertHtmlToMemory(builder.ToString(), null);


            byte[] data = PDF.BinaryData;

            return await Task.Run(async () => File(data, "application/pdf"));
        }
        [HttpGet("[action]")]
        public async Task<ActionResult> contractAsync()
        {
            try
            {
                string Mappath = Path.Combine(_env.WebRootPath, "template", "AgmReport");
                StringBuilder head = new StringBuilder(System.IO.File.ReadAllText(Path.Combine(Mappath, "contract.html")));

                //StringBuilder head = new StringBuilder("<span>1</span>");
                //HiQPdf.HtmlToPdf htmlToPdfConverter = new HiQPdf.HtmlToPdf();

                //var doc = htmlToPdfConverter.Document;
                //var magin = new HiQPdf.PdfMargins();
                //magin.Top = 20;
                //magin.Left = 20;
                //magin.Right = 20;
                //magin.Bottom = 30;
                //htmlToPdfConverter.Document.Margins = magin;  //millimeters
                //                                              //  string baseUrl = string.Concat(Request.Scheme, "://", Request.Host);
                //byte[] data = htmlToPdfConverter.ConvertHtmlToMemory(head.ToString(), null);

                byte[] data = new ReportPDF.Model.ExpertPdf().pdf(head);

                return await Task.Run(async () => File(data, "application/pdf"));
            }
            catch (Exception ex)
            {
                return Ok(new { IsDone = false, ex.Message, ex });
            }


        }
        [HttpGet("[action]")]
        public FileResult angsa()
        {

            string Mappath = Path.Combine(_env.WebRootPath, "template", "AgmReport");
            var fileBytes = (System.IO.File.ReadAllBytes(Path.Combine(Mappath, "angsa.woff")));
            return File(fileBytes, System.Net.Mime.MediaTypeNames.Application.Octet, "angsa.woff");
        }
        [HttpPost("[action]")]
        public async Task<IActionResult> CallApi([FromBody]restmodel model)
        {
            try
            {
                var client = new RestClient(model.Url);
                var request = new RestRequest(model.Method);
                request.AddParameter("application/x-www-form-urlencoded", model.Data, ParameterType.RequestBody);
                IRestResponse response = await client.ExecuteAsync(request);
                {
                    return Ok(new { response.Content, response = response });
                }

            }
            catch (Exception ex)
            {
                return Ok(new { IsDone = false, ex });
            }


        }

        [HttpPost("AB/[action]")]
        public ActionResult tttt([FromBody]restmodel model)
        {
            try
            {
                var client = new RestClient(model.Url);
                var request = new RestRequest(model.Method);
                var body = model.Data;
                request.AddParameter("application/x-www-form-urlencoded", body, ParameterType.RequestBody);
                IRestResponse response = client.Execute(request);
                {
                    return Ok(new { response.Content, response = response });
                }

            }
            catch (Exception ex)
            {
                return Ok(new { IsDone = false, ex });
            }


        }

        [HttpPost("[action]")]
        public async Task<IActionResult> PostData([FromBody]restmodel model)
        {
            try
            {
                var dict = new Dictionary<string, string>();
                dict.Add("grant_type", "authorization_code");
                dict.Add("client_id", "039bb643-891d-4abd-846d-a38c2e89adad");
                dict.Add("redirect_uri", "https://test-scgdistpurchasing.nexterdigitals-dev.com/login");
                dict.Add("code", model.Code);
                var client = new HttpClient();
                var req = new HttpRequestMessage(HttpMethod.Post, model.Url) { Content = new FormUrlEncodedContent(dict) };
                var res = await client.SendAsync(req);
                return Ok(res.Content.ReadAsStringAsync().Result);
            }
            catch (WebException we)
            {
                throw new Exception(we.Message);
            }
            catch (Exception ex)
            {
                return Ok(new { IsDone = false, ex });
            }


        }


        public class WeatherForecast
        {
            public string DateFormatted { get; set; }
            public int TemperatureC { get; set; }
            public string Summary { get; set; }

            public int TemperatureF
            {
                get
                {
                    return 32 + (int)(TemperatureC / 0.5556);
                }
            }
        }
    }
}
